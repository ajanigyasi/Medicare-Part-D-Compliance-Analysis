{
    "collab_server" : "",
    "contents" : "### Diabetic Patient Behavior Analysis \n#Here I will load SAS-formatted survey data from CDC's 2015 Behaviorial Risk Factor Surveillance System and write a \n#readable csv for analysis. Next, I will convert height and weight to meters and kilograms plus label body mass index level. \n\nfilename <- \"E:/CDC/LLCP2015XPT.zip\"\nif (!file.exists(\"LLCP2015.XPT\")) {\n  unzip(filename)\n}\n\n#turn off scientific notation\noptions(stringsAsFactors=F, scipen = 999)\n\npkg = 'Hmisc'\nif (!require(pkg, character.only = TRUE)) {\n  library(pkg, character.only = TRUE)\n}\n\n#write from brfss sas \nbrfss <- sasxport.get(\"LLCP2015.XPT\")\nwrite.csv(brfss, file = \"brfss2015.csv\")\n\n#read brfss \nbrfss <- read.csv(\"brfss2015.csv\", encoding = \"UTF-8\")\n\n\n\n# Convert height and weight to meters and kilograms\nlibrary(dplyr)\n# Height transformation\nheight <- as.data.frame(as.matrix(brfss$height3))\nmetric <- TRUE\nmax_weight <- 999\n\nin_m_filter <- height %>%\n  filter(V1 < 712) %>%\n  mutate(feet = substring(V1, 1, 1)) %>%\n  mutate(inches = substring(V1, 2, nchar(V1))) %>%\n  mutate(meters = ifelse(inches > 12, NaN, (as.numeric(substring(V1, 2, nchar(V1))) + \n                                              as.numeric(substring(V1, 1, 1)) * 12) * 0.0254)) \n\nm_filter <- height %>%\n  filter(V1 < 9999 & V1 >= 9000 & metric) %>%\n  mutate(meters = as.numeric( substring(V1, 2,2)) + (as.numeric(substring(V1, 3, nchar(V1))) * 0.01))  %>%\n  mutate(meters = replace(meters, meters == 0, NaN))\n\n#meters \nheight$meters <- m_filter$meters[match(height$V1, m_filter$V1)]\n\ncolnames(height) <- c(\"compressed\", \"meters\")\n\n\nheight$meters <- ifelse(is.na(height$meters), in_m_filter$meters[match(height$compressed, in_m_filter$V1)],\n                        m_filter$meters[match(height$compressed, m_filter$V1)])\n\n# Weight transformation\nweight <- as.data.frame(as.matrix(brfss$weight2))\n\nkg_filter <- weight %>%\n  filter(V1 < max_weight) %>%\n  mutate(kg = V1 * 0.453592)\n\nkg_sub_filter <- weight %>%\n  filter(V1 < 9999 & metric) %>%\n  mutate(kg = substring(V1, 2, nchar(V1))) \n\n#kilograms\nweight$kg <- ifelse(weight$V1 < max_weight, kg_filter$kg[match(weight$V1, kg_filter$V1)]  , \n                    ifelse( weight$V1 < 9999 & metric,kg_sub_filter$kg[match(weight$V1, kg_sub_filter$V1)],NaN))\n\ncolnames(weight) <- c(\"pounds (lbs)\", \"kg\")\n\n\nbmi <- as.data.frame(round(as.numeric(weight$kg) / (as.numeric(height$meters)^2), 1))\ncolnames(bmi) <- \"bmiCalc\"\n\n\n#BMI strict weight-class labels (Note: BRFSS classifiers are not as strict (i.e. 18.5 as underwt, 25 as normal, 30 as ovet))\n\nbmi$Class[bmi$bmiCalc < 10 | bmi$bmiCalc < 200] <-  NA\nbmi$Class[bmi$bmiCalc >= 10 & bmi$bmiCalc <= 14.9 ] <- \"very severely underweight\"\nbmi$Class[bmi$bmiCalc >= 15 & bmi$bmiCalc <= 15.9] <- \"severely underweight\"\nbmi$Class[bmi$bmiCalc >= 16 & bmi$bmiCalc <= 18.4] <- \"underweight\"\nbmi$Class[bmi$bmiCalc >= 18.5 & bmi$bmiCalc <= 24.9] <- \"normal\"\nbmi$Class[bmi$bmiCalc >= 25 & bmi$bmiCalc <= 29.9] <- \"overweight\"\nbmi$Class[bmi$bmiCalc >= 30 & bmi$bmiCalc <= 34.9] <- \"obese class I\"\nbmi$Class[bmi$bmiCalc >= 35 & bmi$bmiCalc <= 39.9] <- \"obese class II\"\nbmi$Class[bmi$bmiCalc >= 40] <- \"obese class III\"\n\nbmi$Class <- replace(bmi$Class, is.na(bmi$Class), \"overweight\")\n\n#cbind bmi into \"clean\" survey variables of interest\nbrfss <- cbind(brfss, bmi)\n\n# Has a doctor advised you to reduce your sodium or salt intake ? (i.e. To lower blood pressure)\nbrfss$dradvise <- factor(brfss$dradvise, levels = c(1,2), labels = c('yes', 'no'))\nbrfss$dradvise[brfss$dradvise == 7] <- NA\nbrfss$dradvise[brfss$dradvise == 9] <- NA  \n\n# How many times have you been to the doctor for diabetes within 1 year ?\nbrfss$doctdiab <- as.numeric(brfss$doctdiab)\nbrfss$doctdiab[brfss$doctdiab == 88] <- 0\nbrfss$doctdiab[brfss$doctdiab == 77] <- NA\nbrfss$doctdiab[brfss$doctdiab == 99] <- NA   \n\n#Other than regular job, do you exercise any ?\nbrfss$exerany2 <- factor(brfss$exerany2, levels = c(1,2), labels = c('yes',  'no'))\nbrfss$exerany2[brfss$exerany2 == 7] <- NA\nbrfss$exerany2[brfss$exerany2 == 9] <- NA \n\n#Assuming each individual 65 yrs or older has Medicare coverage \nbrfss$x.age65yr <- factor(brfss$x.age65yr, levels = c(1,2), labels = c('18-64', '65+'))\nbrfss$x.age65yr[brfss$x.age65yr == 3] <- NA\n\n#Types of exercises and physical activities and their frequencies amongst targeted individuals\nbrfss$exract11 <- factor(brfss$exract11, \n                         levels = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,\n                                    31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,\n                                    58,59,60,61,62,63,64,66,67,68,69,71,72,73,74,75,76,98), \n                         labels = c('interactive video games', 'aerobics', 'backpacking', 'badminton', 'basketball', \n                                    'bicycling machine','bicycling', 'boating', 'bowling', 'boxing' , 'calisthenics', \n                                    'canoeing/rowing competition', 'carpentry','dancing', 'elliptical', 'fishing' , \n                                    'frisbee', 'gardening', 'golf w/ cart', 'golf w/o cart', 'handball', 'hiking' , \n                                    'hockey', 'horseback riding', 'deer hunting', 'quail hunting', 'inline skating' , \n                                    'jogging', 'lacrosse','mountain climbing' , 'mowing lawn' , 'paddleball' , \n                                    'painting' , 'pilates', 'racquetball','raking lawn', 'running', 'rock climbing', \n                                    'rope skipping', 'rowing machine', 'rugby', 'scuba diving', 'skateboarding' , \n                                    'ice/roller skating' , 'sledding/tobagganing' , 'snorkeling', 'snow blowing', \n                                    'snow shoveling', 'snow skiiing', 'snowshoeing', 'soccer', 'softball/baseball',\n                                    'squash', 'stair master', 'stream fising', 'surfing', 'swimming', 'swimming in laps', \n                                    'table tennis', 'tai chi', 'tennis' , 'touch football' , 'volleyball', 'walking', \n                                    'waterskiing', 'weight lifting', 'wrestling', 'yoga' , 'childcare', 'farm work' , \n                                    'house cleaning/repair', 'karate/mma', 'wheelchair sports','yard work', 'other'))\n\nbrfss$exract11[brfss$exract11 == 77] <- NA\nbrfss$exract11[brfss$exract11 == 99] <- NA \n\nbrfss$x.race <- factor(brfss$x.race, levels = c(1,2,3,4,5,6,7,8),\n                       labels = c('white', 'black', 'native american', 'asian', 'asian/pacific islander',\n                                  'other', 'other/multiracial', 'hispanic'))\nbrfss$x.race[brfss$x.race == 9] <- NA \n\nbrfss$sex <- factor(brfss$sex, levels = c(1,2), labels = c('male', 'female')) #sex\n\n\ndat <- as.data.frame(with(brfss, cbind(x.age65yr, doctdiab, dradvise ,exerany2, Class)))\ndat <- cbind(dat, brfss$exract11, brfss$x.race, brfss$sex)\ndat65 <- subset(dat, x.age65yr == 2)\n",
    "created" : 1505607932182.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3924565330",
    "id" : "723CBF15",
    "lastKnownWriteTime" : 1506905588,
    "last_content_update" : 1506905589159,
    "path" : "E:/CDC/Medicare Part D Compliance Analysis/weightWatchers.R",
    "project_path" : "weightWatchers.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}